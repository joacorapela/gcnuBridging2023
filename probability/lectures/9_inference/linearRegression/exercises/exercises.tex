\documentclass[12pt]{article}

\usepackage{amsmath,amssymb}
\usepackage{verbatim}
\usepackage{enumerate}

\title{Bayesian linear regression exercises}
\author{Joaqu\'{i}n Rapela}

\begin{document}

\maketitle

\section{Decoding reaction time from stimulus contrast}

Consider a visual discrimination task where a subject has to decide if two
simultaneously presented gratings have the same orientation or not. The
experimenter varies the difficulty of the task by changing the contrast of the
gratings, $x$, while she measures the subject reaction times, $t$. Given a set
of $N$ grating contrasts and corresponding subject reaction times,
$(x_1,t_1)\ldots,(x_N,t_N)$, your task is to find the posterior distribution of
the weights, $\mathbf{w}=[w_0,w_1]^\intercal$, of a linear regression model
relating reaction times to grating contrasts

\begin{align}
    \begin{split}
        y(\mathbf{w}, x_n) &= w_0+w_1x_n\\
        t_n &= y(\mathbf{w}, x_n) +\epsilon_n\label{eq:rts}
    \end{split}
\end{align}

\begin{enumerate}[(a)]

    \item Sample N=20 contrast values, $(x_1,\ldots,x_N)$ from a uniform
        distribution in the $[0,1]$ range. For each contrast, $x_n$, sample a
        corresponding reaction time, $t_n=y(a_0,a_1,x_n)+\epsilon_n$, with
        $y(a_0,a_1,x_n)=a_0+a_1x_n$, $a_0=-0.3, a_1=0.5$ and $\epsilon_n$ a
        sample from a Normal distribution with mean zero and standard deviation
        $\sigma=0.2$. Plot $y(a_0,a_1,x)$ as a function of $x$, for
        $x\in[0,1]$. and reaction times, $t_n$, as a function of contrasts,
        $x_n$.

    \item Plot the posterior distribution, $P(\mathbf{w}|t_1,\ldots,t_n)$,
        corresponding to $n=1, 2, 10, 20$ observations, using
        the batch posterior formula. Use a zero-mean normal prior for the
        coefficients, with a variance $alpha=0.5$, with a-priory uncorrelated
        coefficients.

    \item Reproduced the figure from the lecture illustrating the online
        calculation of the posterior distribution. That is, 

        \begin{itemize}
            \item show a contour plot of the prior distribution,

            \item draw 10 weights, $\mathbf{w}$, from the prior
                distribution, and for each weight plot the corresponding
                regression line; i.e., $y(\mathbf{w}, x)$ as a function of $x$,
                for $x\in[0,1]$.

            \item for $=1, 2, 10, 20$ plot

                \begin{itemize}

                    \item contour plot of the likelihood function
                        $p(t_n|\mathbf{w})$, as a function of $w_0$ and $w_1$.

                    \item contour plot of the posterior
                        $p(\mathbf{w}|t_1,\ldots,t_n)$, as a function of $w_0$
                        and $w_1$.

                    \item draw 10 weights, $\mathbf{w}$, from the above
                        posterior distribution, and for each weight plot the
                        corresponding regression line; i.e., $y(\mathbf{w}, x)$
                        as a function of $x$, for $x\in[0,1]$.

                \end{itemize}
        \end{itemize}

    \item check if the the posterior distributions computed using the batch
        formula agree with those calculated using the online procedure.

\end{enumerate}

\end{document}
